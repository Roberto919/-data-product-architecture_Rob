{"paragraphs":[{"text":"%pyspark\n\nspark","user":"anonymous","dateUpdated":"2020-03-25T03:12:54+0000","config":{"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/python","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"<pyspark.sql.session.SparkSession object at 0x7fa919620f10>\n"}]},"apps":[],"jobName":"paragraph_1585104918601_-2057598447","id":"20200324-190609_166135002","dateCreated":"2020-03-25T02:55:18+0000","dateStarted":"2020-03-25T03:12:54+0000","dateFinished":"2020-03-25T03:13:17+0000","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:256"},{"text":"%pyspark\nsc = spark.sparkContext\nsc","user":"anonymous","dateUpdated":"2020-03-25T03:13:57+0000","config":{"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/python","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"<SparkContext master=yarn appName=Zeppelin>\n"}]},"apps":[],"jobName":"paragraph_1585104918605_-172645266","id":"20200324-195342_1519485496","dateCreated":"2020-03-25T02:55:18+0000","dateStarted":"2020-03-25T03:13:57+0000","dateFinished":"2020-03-25T03:13:57+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:257"},{"text":"%md\n\n### I/O\n\nLectura desde csv (en S3)","user":"anonymous","dateUpdated":"2020-03-25T02:55:18+0000","config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"colWidth":12,"editorMode":"ace/mode/markdown","fontSize":9,"editorHide":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<div class=\"markdown-body\">\n<h3>I/O</h3>\n<p>Lectura desde csv (en S3)</p>\n</div>"}]},"apps":[],"jobName":"paragraph_1585104918605_-1045819371","id":"20200324-221615_1526014907","dateCreated":"2020-03-25T02:55:18+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:258"},{"text":"%pyspark \n\nairlines_csv = spark.read.csv(\"s3://dpa/flights/airlines/airlines.csv\", header=\"true\", inferSchema=\"true\")\n# te mostrará los primerros 20 renglones\nairlines_csv.show()\n","user":"anonymous","dateUpdated":"2020-03-25T03:28:59+0000","config":{"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/python","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+---------+--------------------+\n|IATA_CODE|             AIRLINE|\n+---------+--------------------+\n|       UA|United Air Lines ...|\n|       AA|American Airlines...|\n|       US|     US Airways Inc.|\n|       F9|Frontier Airlines...|\n|       B6|     JetBlue Airways|\n|       OO|Skywest Airlines ...|\n|       AS|Alaska Airlines Inc.|\n|       NK|    Spirit Air Lines|\n|       WN|Southwest Airline...|\n|       DL|Delta Air Lines Inc.|\n|       EV|Atlantic Southeas...|\n|       HA|Hawaiian Airlines...|\n|       MQ|American Eagle Ai...|\n|       VX|      Virgin America|\n+---------+--------------------+\n\n"}]},"apps":[],"jobName":"paragraph_1585104918605_-2016465132","id":"20200324-191043_2060266829","dateCreated":"2020-03-25T02:55:18+0000","dateStarted":"2020-03-25T03:28:59+0000","dateFinished":"2020-03-25T03:29:08+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:259"},{"text":"%pyspark\n\nairlines_csv.printSchema()","user":"anonymous","dateUpdated":"2020-03-25T02:55:18+0000","config":{"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/python","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"root\n |-- IATA_CODE: string (nullable = true)\n |-- AIRLINE: string (nullable = true)\n\n"}]},"apps":[],"jobName":"paragraph_1585104918606_387598723","id":"20200324-193136_1170689816","dateCreated":"2020-03-25T02:55:18+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:260"},{"text":"%md\n\nEscritura a parquet en S3\n","user":"anonymous","dateUpdated":"2020-03-25T02:55:18+0000","config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"colWidth":12,"editorMode":"ace/mode/markdown","fontSize":9,"editorHide":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<div class=\"markdown-body\">\n<p>Escritura a parquet en S3</p>\n</div>"}]},"apps":[],"jobName":"paragraph_1585104918606_-41557941","id":"20200324-221712_212006460","dateCreated":"2020-03-25T02:55:18+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:261"},{"text":"%pyspark\n\nairlines_csv.write.parquet(\"s3://dpa/flights/airlines/parquet/\", mode=\"overwrite\")","user":"anonymous","dateUpdated":"2020-03-25T03:29:20+0000","config":{"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/python","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"jobName":"paragraph_1585104918607_710149648","id":"20200324-191636_1780507591","dateCreated":"2020-03-25T02:55:18+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:262","dateFinished":"2020-03-25T03:29:22+0000","dateStarted":"2020-03-25T03:29:20+0000"},{"text":"%md\n\nEscritura en parquet a S3\n","user":"anonymous","dateUpdated":"2020-03-25T02:55:18+0000","config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"colWidth":12,"editorMode":"ace/mode/markdown","fontSize":9,"editorHide":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<div class=\"markdown-body\">\n<p>Escritura en parquet a S3</p>\n</div>"}]},"apps":[],"jobName":"paragraph_1585104918607_1060723838","id":"20200324-221734_1055763125","dateCreated":"2020-03-25T02:55:18+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:263"},{"text":"%pyspark\nairlines_parquet = spark.read.parquet(\"s3://dpa/flights/airlines/parquet/\")\nairlines_parquet.show()\n","user":"anonymous","dateUpdated":"2020-03-25T03:30:59+0000","config":{"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/python","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+---------+--------------------+\n|IATA_CODE|             AIRLINE|\n+---------+--------------------+\n|       UA|United Air Lines ...|\n|       AA|American Airlines...|\n|       US|     US Airways Inc.|\n|       F9|Frontier Airlines...|\n|       B6|     JetBlue Airways|\n|       OO|Skywest Airlines ...|\n|       AS|Alaska Airlines Inc.|\n|       NK|    Spirit Air Lines|\n|       WN|Southwest Airline...|\n|       DL|Delta Air Lines Inc.|\n|       EV|Atlantic Southeas...|\n|       HA|Hawaiian Airlines...|\n|       MQ|American Eagle Ai...|\n|       VX|      Virgin America|\n+---------+--------------------+\n\n"}]},"apps":[],"jobName":"paragraph_1585104918607_1897999347","id":"20200324-191940_494737672","dateCreated":"2020-03-25T02:55:18+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:264","dateFinished":"2020-03-25T03:31:08+0000","dateStarted":"2020-03-25T03:30:59+0000"},{"text":"%pyspark\nairlines_parquet.printSchema()","user":"anonymous","dateUpdated":"2020-03-25T03:31:14+0000","config":{"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/python","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"root\n |-- IATA_CODE: string (nullable = true)\n |-- AIRLINE: string (nullable = true)\n\n"}]},"apps":[],"jobName":"paragraph_1585104918607_2129284759","id":"20200324-193257_1805500162","dateCreated":"2020-03-25T02:55:18+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:265","dateFinished":"2020-03-25T03:31:14+0000","dateStarted":"2020-03-25T03:31:14+0000"},{"text":"%pyspark\nairlines_parquet.count()\n","user":"anonymous","dateUpdated":"2020-03-25T03:31:21+0000","config":{"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/python","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"14\n"}]},"apps":[],"jobName":"paragraph_1585104918608_-1220111241","id":"20200324-194118_435511932","dateCreated":"2020-03-25T02:55:18+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:266","dateFinished":"2020-03-25T03:31:22+0000","dateStarted":"2020-03-25T03:31:21+0000"},{"text":"%md \n\n`describe()` es un transformador, no una acción, para poder \"ejecutarlo\" tienes que poner una acción, en este caso `show()`\n","user":"anonymous","dateUpdated":"2020-03-25T02:55:18+0000","config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"colWidth":12,"editorMode":"ace/mode/markdown","fontSize":9,"editorHide":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<div class=\"markdown-body\">\n<p><code>describe()</code> es un transformador, no una acción, para poder &ldquo;ejecutarlo&rdquo; tienes que poner una acción, en este caso <code>show()</code></p>\n</div>"}]},"apps":[],"jobName":"paragraph_1585104918608_1459905623","id":"20200324-221908_224593807","dateCreated":"2020-03-25T02:55:18+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:267"},{"text":"%pyspark\nairlines_csv.describe().show()","user":"anonymous","dateUpdated":"2020-03-25T02:55:18+0000","config":{"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/python","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+-------+---------+--------------------+\n|summary|IATA_CODE|             AIRLINE|\n+-------+---------+--------------------+\n|  count|       14|                  14|\n|   mean|     null|                null|\n| stddev|     null|                null|\n|    min|       AA|Alaska Airlines Inc.|\n|    max|       WN|      Virgin America|\n+-------+---------+--------------------+\n\n"}]},"apps":[],"jobName":"paragraph_1585104918608_743852276","id":"20200324-194137_725818376","dateCreated":"2020-03-25T02:55:18+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:268"},{"text":"%md\n\nLectura de csv desde s3\n","user":"anonymous","dateUpdated":"2020-03-25T02:55:18+0000","config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"colWidth":12,"editorMode":"ace/mode/markdown","fontSize":9,"editorHide":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<div class=\"markdown-body\">\n<p>Lectura de csv desde s3</p>\n</div>"}]},"apps":[],"jobName":"paragraph_1585104918608_-4327202","id":"20200324-221958_696319574","dateCreated":"2020-03-25T02:55:18+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:269"},{"text":"%pyspark\nflights_csv = spark.read.csv(\"s3://dpa/flights/flights.csv\", header=True, inferSchema=True)\nflights_csv.count()","user":"anonymous","dateUpdated":"2020-03-25T03:32:22+0000","config":{"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/python","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"5819079\n"}]},"apps":[],"jobName":"paragraph_1585104918609_-2113971274","id":"20200324-194357_1680141094","dateCreated":"2020-03-25T02:55:18+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:270","dateFinished":"2020-03-25T03:32:46+0000","dateStarted":"2020-03-25T03:32:22+0000"},{"text":"%pyspark\nflights_csv.show(5)","user":"anonymous","dateUpdated":"2020-03-25T03:33:41+0000","config":{"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/python","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+----+-----+---+-----------+-------+-------------+-----------+--------------+-------------------+-------------------+--------------+---------------+--------+----------+--------------+------------+--------+--------+---------+-------+-----------------+------------+-------------+--------+---------+-------------------+----------------+--------------+-------------+-------------------+-------------+\n|YEAR|MONTH|DAY|DAY_OF_WEEK|AIRLINE|FLIGHT_NUMBER|TAIL_NUMBER|ORIGIN_AIRPORT|DESTINATION_AIRPORT|SCHEDULED_DEPARTURE|DEPARTURE_TIME|DEPARTURE_DELAY|TAXI_OUT|WHEELS_OFF|SCHEDULED_TIME|ELAPSED_TIME|AIR_TIME|DISTANCE|WHEELS_ON|TAXI_IN|SCHEDULED_ARRIVAL|ARRIVAL_TIME|ARRIVAL_DELAY|DIVERTED|CANCELLED|CANCELLATION_REASON|AIR_SYSTEM_DELAY|SECURITY_DELAY|AIRLINE_DELAY|LATE_AIRCRAFT_DELAY|WEATHER_DELAY|\n+----+-----+---+-----------+-------+-------------+-----------+--------------+-------------------+-------------------+--------------+---------------+--------+----------+--------------+------------+--------+--------+---------+-------+-----------------+------------+-------------+--------+---------+-------------------+----------------+--------------+-------------+-------------------+-------------+\n|2015|    1|  1|          4|     AS|           98|     N407AS|           ANC|                SEA|                  5|          2354|            -11|      21|        15|           205|         194|     169|    1448|      404|      4|              430|         408|          -22|       0|        0|               null|            null|          null|         null|               null|         null|\n|2015|    1|  1|          4|     AA|         2336|     N3KUAA|           LAX|                PBI|                 10|             2|             -8|      12|        14|           280|         279|     263|    2330|      737|      4|              750|         741|           -9|       0|        0|               null|            null|          null|         null|               null|         null|\n|2015|    1|  1|          4|     US|          840|     N171US|           SFO|                CLT|                 20|            18|             -2|      16|        34|           286|         293|     266|    2296|      800|     11|              806|         811|            5|       0|        0|               null|            null|          null|         null|               null|         null|\n|2015|    1|  1|          4|     AA|          258|     N3HYAA|           LAX|                MIA|                 20|            15|             -5|      15|        30|           285|         281|     258|    2342|      748|      8|              805|         756|           -9|       0|        0|               null|            null|          null|         null|               null|         null|\n|2015|    1|  1|          4|     AS|          135|     N527AS|           SEA|                ANC|                 25|            24|             -1|      11|        35|           235|         215|     199|    1448|      254|      5|              320|         259|          -21|       0|        0|               null|            null|          null|         null|               null|         null|\n+----+-----+---+-----------+-------+-------------+-----------+--------------+-------------------+-------------------+--------------+---------------+--------+----------+--------------+------------+--------+--------+---------+-------+-----------------+------------+-------------+--------+---------+-------------------+----------------+--------------+-------------+-------------------+-------------+\nonly showing top 5 rows\n\n"}]},"apps":[],"jobName":"paragraph_1585104918609_2144010974","id":"20200324-194445_1361721631","dateCreated":"2020-03-25T02:55:18+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:271","dateFinished":"2020-03-25T03:33:42+0000","dateStarted":"2020-03-25T03:33:42+0000"},{"text":"%pyspark\nflights_csv.printSchema()","user":"anonymous","dateUpdated":"2020-03-25T03:34:08+0000","config":{"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/python","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"root\n |-- YEAR: integer (nullable = true)\n |-- MONTH: integer (nullable = true)\n |-- DAY: integer (nullable = true)\n |-- DAY_OF_WEEK: integer (nullable = true)\n |-- AIRLINE: string (nullable = true)\n |-- FLIGHT_NUMBER: integer (nullable = true)\n |-- TAIL_NUMBER: string (nullable = true)\n |-- ORIGIN_AIRPORT: string (nullable = true)\n |-- DESTINATION_AIRPORT: string (nullable = true)\n |-- SCHEDULED_DEPARTURE: integer (nullable = true)\n |-- DEPARTURE_TIME: integer (nullable = true)\n |-- DEPARTURE_DELAY: integer (nullable = true)\n |-- TAXI_OUT: integer (nullable = true)\n |-- WHEELS_OFF: integer (nullable = true)\n |-- SCHEDULED_TIME: integer (nullable = true)\n |-- ELAPSED_TIME: integer (nullable = true)\n |-- AIR_TIME: integer (nullable = true)\n |-- DISTANCE: integer (nullable = true)\n |-- WHEELS_ON: integer (nullable = true)\n |-- TAXI_IN: integer (nullable = true)\n |-- SCHEDULED_ARRIVAL: integer (nullable = true)\n |-- ARRIVAL_TIME: integer (nullable = true)\n |-- ARRIVAL_DELAY: integer (nullable = true)\n |-- DIVERTED: integer (nullable = true)\n |-- CANCELLED: integer (nullable = true)\n |-- CANCELLATION_REASON: string (nullable = true)\n |-- AIR_SYSTEM_DELAY: integer (nullable = true)\n |-- SECURITY_DELAY: integer (nullable = true)\n |-- AIRLINE_DELAY: integer (nullable = true)\n |-- LATE_AIRCRAFT_DELAY: integer (nullable = true)\n |-- WEATHER_DELAY: integer (nullable = true)\n\n"}]},"apps":[],"jobName":"paragraph_1585104918609_135748161","id":"20200324-194957_1148821174","dateCreated":"2020-03-25T02:55:18+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:272","dateFinished":"2020-03-25T03:34:09+0000","dateStarted":"2020-03-25T03:34:09+0000"},{"text":"%pyspark\nflights_csv.write.parquet(\"s3://dpa/flights/parquet/\", mode=\"overwrite\")","user":"anonymous","dateUpdated":"2020-03-25T03:35:09+0000","config":{"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/python","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"jobName":"paragraph_1585104918610_159322660","id":"20200324-194453_87249833","dateCreated":"2020-03-25T02:55:18+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:273","dateFinished":"2020-03-25T03:35:41+0000","dateStarted":"2020-03-25T03:35:09+0000"},{"text":"%pyspark\nflights = spark.read.parquet(\"s3://dpa/flights/parquet/\")\nflights.count()","user":"anonymous","dateUpdated":"2020-03-25T03:36:44+0000","config":{"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/python","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"5819079\n"}]},"apps":[],"jobName":"paragraph_1585104918610_1819947998","id":"20200324-194548_1833277093","dateCreated":"2020-03-25T02:55:18+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:274","dateFinished":"2020-03-25T03:36:52+0000","dateStarted":"2020-03-25T03:36:44+0000"},{"text":"%pyspark\nflights.printSchema()","user":"anonymous","dateUpdated":"2020-03-25T03:38:05+0000","config":{"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/python","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"root\n |-- YEAR: integer (nullable = true)\n |-- MONTH: integer (nullable = true)\n |-- DAY: integer (nullable = true)\n |-- DAY_OF_WEEK: integer (nullable = true)\n |-- AIRLINE: string (nullable = true)\n |-- FLIGHT_NUMBER: integer (nullable = true)\n |-- TAIL_NUMBER: string (nullable = true)\n |-- ORIGIN_AIRPORT: string (nullable = true)\n |-- DESTINATION_AIRPORT: string (nullable = true)\n |-- SCHEDULED_DEPARTURE: integer (nullable = true)\n |-- DEPARTURE_TIME: integer (nullable = true)\n |-- DEPARTURE_DELAY: integer (nullable = true)\n |-- TAXI_OUT: integer (nullable = true)\n |-- WHEELS_OFF: integer (nullable = true)\n |-- SCHEDULED_TIME: integer (nullable = true)\n |-- ELAPSED_TIME: integer (nullable = true)\n |-- AIR_TIME: integer (nullable = true)\n |-- DISTANCE: integer (nullable = true)\n |-- WHEELS_ON: integer (nullable = true)\n |-- TAXI_IN: integer (nullable = true)\n |-- SCHEDULED_ARRIVAL: integer (nullable = true)\n |-- ARRIVAL_TIME: integer (nullable = true)\n |-- ARRIVAL_DELAY: integer (nullable = true)\n |-- DIVERTED: integer (nullable = true)\n |-- CANCELLED: integer (nullable = true)\n |-- CANCELLATION_REASON: string (nullable = true)\n |-- AIR_SYSTEM_DELAY: integer (nullable = true)\n |-- SECURITY_DELAY: integer (nullable = true)\n |-- AIRLINE_DELAY: integer (nullable = true)\n |-- LATE_AIRCRAFT_DELAY: integer (nullable = true)\n |-- WEATHER_DELAY: integer (nullable = true)\n\n"}]},"apps":[],"jobName":"paragraph_1585104918611_-1360570797","id":"20200324-194851_746608056","dateCreated":"2020-03-25T02:55:18+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:276","dateFinished":"2020-03-25T03:38:05+0000","dateStarted":"2020-03-25T03:38:05+0000","focus":true},{"text":"%pyspark\n# así es como hacemos la estrategia de partitioning !!! \nflights_csv.write.parquet(\"s3://dpa/fligths/partition_2/\", mode=\"overwrite\", partitionBy=[\"YEAR\", \"MONTH\"])","user":"anonymous","dateUpdated":"2020-03-25T03:42:54+0000","config":{"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/python","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"jobName":"paragraph_1585104918610_-43701730","id":"20200324-195047_844352508","dateCreated":"2020-03-25T02:55:18+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:275","dateFinished":"2020-03-25T03:43:29+0000","dateStarted":"2020-03-25T03:42:54+0000"},{"text":"%md\n\nCambiemos los nombres de las columnas a minúsculas","user":"anonymous","dateUpdated":"2020-03-25T02:55:18+0000","config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"colWidth":12,"editorMode":"ace/mode/markdown","fontSize":9,"editorHide":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<div class=\"markdown-body\">\n<p>Cambiemos los nombres de las columnas a minúsculas</p>\n</div>"}]},"apps":[],"jobName":"paragraph_1585104918611_1542778939","id":"20200324-230357_769998215","dateCreated":"2020-03-25T02:55:18+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:277"},{"text":"%pyspark\n\nflights.columns","user":"anonymous","dateUpdated":"2020-03-25T03:46:11+0000","config":{"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/python","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"['YEAR', 'MONTH', 'DAY', 'DAY_OF_WEEK', 'AIRLINE', 'FLIGHT_NUMBER', 'TAIL_NUMBER', 'ORIGIN_AIRPORT', 'DESTINATION_AIRPORT', 'SCHEDULED_DEPARTURE', 'DEPARTURE_TIME', 'DEPARTURE_DELAY', 'TAXI_OUT', 'WHEELS_OFF', 'SCHEDULED_TIME', 'ELAPSED_TIME', 'AIR_TIME', 'DISTANCE', 'WHEELS_ON', 'TAXI_IN', 'SCHEDULED_ARRIVAL', 'ARRIVAL_TIME', 'ARRIVAL_DELAY', 'DIVERTED', 'CANCELLED', 'CANCELLATION_REASON', 'AIR_SYSTEM_DELAY', 'SECURITY_DELAY', 'AIRLINE_DELAY', 'LATE_AIRCRAFT_DELAY', 'WEATHER_DELAY']\n"}]},"apps":[],"jobName":"paragraph_1585104918611_-1012225416","id":"20200324-230419_1316418379","dateCreated":"2020-03-25T02:55:18+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:278","dateFinished":"2020-03-25T03:46:11+0000","dateStarted":"2020-03-25T03:46:11+0000"},{"text":"%pyspark\n\n# withColumnRenamed\n\noriginal = flights.columns\nnew_col_names = [element.lower() for element in flights.columns]\n\ndf = reduce(lambda flights, idx: flights.withColumnRenamed(original[idx], new_col_names[idx]), range(len(original)), flights)\ndf.show()\n","user":"anonymous","dateUpdated":"2020-03-25T02:55:18+0000","config":{"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/python","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+----+-----+---+-----------+-------+-------------+-----------+--------------+-------------------+-------------------+--------------+---------------+--------+----------+--------------+------------+--------+--------+---------+-------+-----------------+------------+-------------+--------+---------+-------------------+----------------+--------------+-------------+-------------------+-------------+\n|year|month|day|day_of_week|airline|flight_number|tail_number|origin_airport|destination_airport|scheduled_departure|departure_time|departure_delay|taxi_out|wheels_off|scheduled_time|elapsed_time|air_time|distance|wheels_on|taxi_in|scheduled_arrival|arrival_time|arrival_delay|diverted|cancelled|cancellation_reason|air_system_delay|security_delay|airline_delay|late_aircraft_delay|weather_delay|\n+----+-----+---+-----------+-------+-------------+-----------+--------------+-------------------+-------------------+--------------+---------------+--------+----------+--------------+------------+--------+--------+---------+-------+-----------------+------------+-------------+--------+---------+-------------------+----------------+--------------+-------------+-------------------+-------------+\n|2015|    1|  1|          4|     AS|           98|     N407AS|           ANC|                SEA|                  5|          2354|            -11|      21|        15|           205|         194|     169|    1448|      404|      4|              430|         408|          -22|       0|        0|               null|            null|          null|         null|               null|         null|\n|2015|    1|  1|          4|     AA|         2336|     N3KUAA|           LAX|                PBI|                 10|             2|             -8|      12|        14|           280|         279|     263|    2330|      737|      4|              750|         741|           -9|       0|        0|               null|            null|          null|         null|               null|         null|\n|2015|    1|  1|          4|     US|          840|     N171US|           SFO|                CLT|                 20|            18|             -2|      16|        34|           286|         293|     266|    2296|      800|     11|              806|         811|            5|       0|        0|               null|            null|          null|         null|               null|         null|\n|2015|    1|  1|          4|     AA|          258|     N3HYAA|           LAX|                MIA|                 20|            15|             -5|      15|        30|           285|         281|     258|    2342|      748|      8|              805|         756|           -9|       0|        0|               null|            null|          null|         null|               null|         null|\n|2015|    1|  1|          4|     AS|          135|     N527AS|           SEA|                ANC|                 25|            24|             -1|      11|        35|           235|         215|     199|    1448|      254|      5|              320|         259|          -21|       0|        0|               null|            null|          null|         null|               null|         null|\n|2015|    1|  1|          4|     DL|          806|     N3730B|           SFO|                MSP|                 25|            20|             -5|      18|        38|           217|         230|     206|    1589|      604|      6|              602|         610|            8|       0|        0|               null|            null|          null|         null|               null|         null|\n|2015|    1|  1|          4|     NK|          612|     N635NK|           LAS|                MSP|                 25|            19|             -6|      11|        30|           181|         170|     154|    1299|      504|      5|              526|         509|          -17|       0|        0|               null|            null|          null|         null|               null|         null|\n|2015|    1|  1|          4|     US|         2013|     N584UW|           LAX|                CLT|                 30|            44|             14|      13|        57|           273|         249|     228|    2125|      745|      8|              803|         753|          -10|       0|        0|               null|            null|          null|         null|               null|         null|\n|2015|    1|  1|          4|     AA|         1112|     N3LAAA|           SFO|                DFW|                 30|            19|            -11|      17|        36|           195|         193|     173|    1464|      529|      3|              545|         532|          -13|       0|        0|               null|            null|          null|         null|               null|         null|\n|2015|    1|  1|          4|     DL|         1173|     N826DN|           LAS|                ATL|                 30|            33|              3|      12|        45|           221|         203|     186|    1747|      651|      5|              711|         656|          -15|       0|        0|               null|            null|          null|         null|               null|         null|\n|2015|    1|  1|          4|     DL|         2336|     N958DN|           DEN|                ATL|                 30|            24|             -6|      12|        36|           173|         149|     133|    1199|      449|      4|              523|         453|          -30|       0|        0|               null|            null|          null|         null|               null|         null|\n|2015|    1|  1|          4|     AA|         1674|     N853AA|           LAS|                MIA|                 35|            27|             -8|      21|        48|           268|         266|     238|    2174|      746|      7|              803|         753|          -10|       0|        0|               null|            null|          null|         null|               null|         null|\n|2015|    1|  1|          4|     DL|         1434|     N547US|           LAX|                MSP|                 35|            35|              0|      18|        53|           214|         210|     188|    1535|      601|      4|              609|         605|           -4|       0|        0|               null|            null|          null|         null|               null|         null|\n|2015|    1|  1|          4|     DL|         2324|     N3751B|           SLC|                ATL|                 40|            34|             -6|      18|        52|           215|         199|     176|    1590|      548|      5|              615|         553|          -22|       0|        0|               null|            null|          null|         null|               null|         null|\n|2015|    1|  1|          4|     DL|         2440|     N651DL|           SEA|                MSP|                 40|            39|             -1|      28|       107|           189|         198|     166|    1399|      553|      4|              549|         557|            8|       0|        0|               null|            null|          null|         null|               null|         null|\n|2015|    1|  1|          4|     AS|          108|     N309AS|           ANC|                SEA|                 45|            41|             -4|      17|        58|           204|         194|     173|    1448|      451|      4|              509|         455|          -14|       0|        0|               null|            null|          null|         null|               null|         null|\n|2015|    1|  1|          4|     DL|         1560|     N3743H|           ANC|                SEA|                 45|            31|            -14|      25|        56|           210|         200|     171|    1448|      447|      4|              515|         451|          -24|       0|        0|               null|            null|          null|         null|               null|         null|\n|2015|    1|  1|          4|     UA|         1197|     N78448|           SFO|                IAH|                 48|            42|             -6|      11|        53|           218|         217|     199|    1635|      612|      7|              626|         619|           -7|       0|        0|               null|            null|          null|         null|               null|         null|\n|2015|    1|  1|          4|     AS|          122|     N413AS|           ANC|                PDX|                 50|            46|             -4|      11|        57|           215|         201|     187|    1542|      504|      3|              525|         507|          -18|       0|        0|               null|            null|          null|         null|               null|         null|\n|2015|    1|  1|          4|     DL|         1670|     N806DN|           PDX|                MSP|                 50|            45|             -5|       9|        54|           193|         186|     171|    1426|      545|      6|              603|         551|          -12|       0|        0|               null|            null|          null|         null|               null|         null|\n+----+-----+---+-----------+-------+-------------+-----------+--------------+-------------------+-------------------+--------------+---------------+--------+----------+--------------+------------+--------+--------+---------+-------+-----------------+------------+-------------+--------+---------+-------------------+----------------+--------------+-------------+-------------------+-------------+\nonly showing top 20 rows\n\n"}]},"apps":[],"jobName":"paragraph_1585104918611_-1816759377","id":"20200324-230438_1606138341","dateCreated":"2020-03-25T02:55:18+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:279"},{"text":"%pyspark\ndf.printSchema()","user":"anonymous","dateUpdated":"2020-03-25T02:55:18+0000","config":{"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/python","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"root\n |-- year: integer (nullable = true)\n |-- month: integer (nullable = true)\n |-- day: integer (nullable = true)\n |-- day_of_week: integer (nullable = true)\n |-- airline: string (nullable = true)\n |-- flight_number: integer (nullable = true)\n |-- tail_number: string (nullable = true)\n |-- origin_airport: string (nullable = true)\n |-- destination_airport: string (nullable = true)\n |-- scheduled_departure: integer (nullable = true)\n |-- departure_time: integer (nullable = true)\n |-- departure_delay: integer (nullable = true)\n |-- taxi_out: integer (nullable = true)\n |-- wheels_off: integer (nullable = true)\n |-- scheduled_time: integer (nullable = true)\n |-- elapsed_time: integer (nullable = true)\n |-- air_time: integer (nullable = true)\n |-- distance: integer (nullable = true)\n |-- wheels_on: integer (nullable = true)\n |-- taxi_in: integer (nullable = true)\n |-- scheduled_arrival: integer (nullable = true)\n |-- arrival_time: integer (nullable = true)\n |-- arrival_delay: integer (nullable = true)\n |-- diverted: integer (nullable = true)\n |-- cancelled: integer (nullable = true)\n |-- cancellation_reason: string (nullable = true)\n |-- air_system_delay: integer (nullable = true)\n |-- security_delay: integer (nullable = true)\n |-- airline_delay: integer (nullable = true)\n |-- late_aircraft_delay: integer (nullable = true)\n |-- weather_delay: integer (nullable = true)\n\n"}]},"apps":[],"jobName":"paragraph_1585104918612_-607270177","id":"20200324-231616_1026857679","dateCreated":"2020-03-25T02:55:18+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:280"},{"text":"%md\n\nTambién es posible manipular los datos a través de tablas de SQL, para ello puedes ocupar el método `createOrReplaceTempView`\n","user":"anonymous","dateUpdated":"2020-03-25T02:55:18+0000","config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"colWidth":12,"editorMode":"ace/mode/markdown","fontSize":9,"editorHide":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<div class=\"markdown-body\">\n<p>También es posible manipular los datos a través de tablas de SQL, para ello puedes ocupar el método <code>createOrReplaceTempView</code></p>\n</div>"}]},"apps":[],"jobName":"paragraph_1585104918612_-1775567496","id":"20200324-234914_824381204","dateCreated":"2020-03-25T02:55:18+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:281"},{"text":"%pyspark\ndf.createOrReplaceTempView(\"vuelos\")\nspark.sql(\"select count(*) from vuelos\").show()\n","user":"anonymous","dateUpdated":"2020-03-25T02:55:18+0000","config":{"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/python","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+--------+\n|count(1)|\n+--------+\n| 5819079|\n+--------+\n\n"}]},"apps":[],"jobName":"paragraph_1585104918612_-1618670438","id":"20200324-235006_950267789","dateCreated":"2020-03-25T02:55:18+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:282"},{"text":"%pyspark\nspark.sql(\"select origin_airport, count(*) from vuelos group by origin_airport order by count(*) desc\").show()","user":"anonymous","dateUpdated":"2020-03-25T02:55:18+0000","config":{"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/python","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+--------------+--------+\n|origin_airport|count(1)|\n+--------------+--------+\n|           ATL|  346836|\n|           ORD|  285884|\n|           DFW|  239551|\n|           DEN|  196055|\n|           LAX|  194673|\n|           SFO|  148008|\n|           PHX|  146815|\n|           IAH|  146622|\n|           LAS|  133181|\n|           MSP|  112117|\n|           MCO|  110982|\n|           SEA|  110899|\n|           DTW|  108500|\n|           BOS|  107847|\n|           EWR|  101772|\n|           CLT|  100324|\n|           LGA|   99605|\n|           SLC|   97210|\n|           JFK|   93811|\n|           BWI|   86079|\n+--------------+--------+\nonly showing top 20 rows\n\n"}]},"apps":[],"jobName":"paragraph_1585104918613_1032800534","id":"20200324-235503_1616264600","dateCreated":"2020-03-25T02:55:18+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:283"},{"text":"%pyspark\nairlines_from_flights = spark.sql(\"select distinct airline from vuelos\").show()\nairlines_from_flights","user":"anonymous","dateUpdated":"2020-03-25T02:55:18+0000","config":{"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/python","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+-------+\n|airline|\n+-------+\n|     UA|\n|     NK|\n|     AA|\n|     EV|\n|     B6|\n|     DL|\n|     OO|\n|     F9|\n|     US|\n|     MQ|\n|     HA|\n|     AS|\n|     VX|\n|     WN|\n+-------+\n\n"}]},"apps":[],"jobName":"paragraph_1585104918613_-1285291063","id":"20200324-235757_180257804","dateCreated":"2020-03-25T02:55:18+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:284"},{"text":"%pyspark\nsql_query = \"\"\"\nselect year, month, day, airline, origin_airport, destination_airport, departure_delay\nfrom vuelos\nwhere departure_delay > 0 \nand departure_delay < 100\n\"\"\" \n\ndeparture_delays = spark.sql(sql_query)","user":"anonymous","dateUpdated":"2020-03-25T02:55:18+0000","config":{"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/python","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"jobName":"paragraph_1585104918613_-1451019495","id":"20200324-235946_636134772","dateCreated":"2020-03-25T02:55:18+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:285"},{"text":"%pyspark\ndeparture_delays.count()","user":"anonymous","dateUpdated":"2020-03-25T02:55:18+0000","config":{"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/python","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"1963214\n"}]},"apps":[],"jobName":"paragraph_1585104918614_-438882662","id":"20200325-000405_1236873215","dateCreated":"2020-03-25T02:55:18+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:286"},{"text":"%pyspark\ndeparture_delays.show()","user":"anonymous","dateUpdated":"2020-03-25T02:55:18+0000","config":{"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/python","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+----+-----+---+-------+--------------+-------------------+---------------+\n|year|month|day|airline|origin_airport|destination_airport|departure_delay|\n+----+-----+---+-------+--------------+-------------------+---------------+\n|2015|    1|  1|     US|           LAX|                CLT|             14|\n|2015|    1|  1|     DL|           LAS|                ATL|              3|\n|2015|    1|  1|     NK|           LAS|                MCI|             25|\n|2015|    1|  1|     NK|           MSP|                FLL|             12|\n|2015|    1|  1|     AA|           DEN|                MIA|             21|\n|2015|    1|  1|     NK|           PHX|                ORD|             72|\n|2015|    1|  1|     UA|           SJU|                EWR|              3|\n|2015|    1|  1|     B6|           SJU|                MCO|             95|\n|2015|    1|  1|     B6|           BQN|                MCO|              4|\n|2015|    1|  1|     B6|           SJU|                BDL|             72|\n|2015|    1|  1|     OO|           ONT|                SFO|             13|\n|2015|    1|  1|     UA|           ORD|                IAH|              4|\n|2015|    1|  1|     EV|           MKE|                IAH|              2|\n|2015|    1|  1|     US|           PDX|                PHX|             60|\n|2015|    1|  1|     AA|           IAH|                MIA|             58|\n|2015|    1|  1|     OO|           BOI|                SFO|              5|\n|2015|    1|  1|     UA|           PHL|                IAH|              2|\n|2015|    1|  1|     UA|           PDX|                DEN|              4|\n|2015|    1|  1|     AA|           DEN|                DFW|             53|\n|2015|    1|  1|     UA|           SFO|                DEN|             19|\n+----+-----+---+-------+--------------+-------------------+---------------+\nonly showing top 20 rows\n\n"}]},"apps":[],"jobName":"paragraph_1585104918614_1324106650","id":"20200325-000419_574294577","dateCreated":"2020-03-25T02:55:18+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:287"},{"text":"%md\n\nAlgunos ejericios para que te empieces a empapar de pysparksql \n\n1. ¿Cuántas aerolíneas existen en tu *dataset*?\n2. ¿Cuántos aviones -`tail number`- diferentes existen en tu *dataset*?\n3. ¿De qué periodo de tiempo tienes vuelos? ¿Tienes datos de todos los días en ese periódo?\n4. ¿Cuál es el día de la semana con menor demoras de salida?\n5. ¿Cuál es el origen-destino con el mayor porcentaje de demoras en su salida? ¿Qué porcentaje es?\n6. ¿Cuál es el aeropuerto destino con mayor número de demoras (número, no duración de la demora)? ¿De qué aerolíneas son el top 3 de demoras de este aeropuerto?\n7. ¿Cuál es el aeropuerto origen con mayor número de demoras (número, no duración de la demora)? ¿De qué aerolíneas son el top 3 de demoras de este aeropuerto?\n8. ¿Qué aerolíneas vuelan de Atlanta (Hartsfield-Jackson Atlanta International Airport) a Hawaii (Honolulu International Airport) y en qué dias de la semana y horarios?\n9. Si queremos viajar de Atlanta (Hartsfield-Jackson Atlanta International Airport) a Hawaii (Honolulu International Airport) en qué día nos conviene hacerlo para no tener demoras en nuestra salida.\n10. Si queremos viajar de Atlanta (Hartsfield-Jackson Atlanta International Airport) a Hawaii (Honolulu International Airport) en qué día nos conviene hacerlo para no tener demoras en nuestra llegada.\n11. Si queremos viajar de Atlanta (Hartsfield-Jackson Atlanta International Airport) a Hawaii (Honolulu International Airport) en qué día nos conviene hacerlo para no tener demoras en nuestro viaje. (demora incluyendo demora de salida y demora de llegada).\n12. ¿Qué aerolínea es a la que más destinos llega?\n13. ¿Qué aeropuerto es el que recibe más destinos?\n14. ¿Qué aeropuerto es el que llega a más destinos?\n15. ¿Qué aeropuerto es el más puntual los fines de semana para salidas?\n16. ¿Qué aeropuerto es el más puntual los lunes para salidas?\n17. ¿Qué aeropuerto es el más puntual en todos sus viajes salidas y llegadas?\n18. ¿Cuál es la ruta con menor demora? ¿Por cuánto es la demora? (Tienen que tener demora, demora = demora de salida + demora de llegada).\n19. ¿Cuál es la ruta con mayor demora? ¿Por cuánto es la demora? (demora = demora salida + demora de llegada).\n20. En qué día de la semana debemos viajar desde el aeropuerto John F. Kennedy para no tener demora en la salida (sin importar el destino).\n","user":"anonymous","dateUpdated":"2020-03-25T02:55:18+0000","config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"colWidth":12,"editorMode":"ace/mode/markdown","fontSize":9,"editorHide":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<div class=\"markdown-body\">\n<p>Algunos ejericios para que te empieces a empapar de pysparksql </p>\n<ol>\n  <li>¿Cuántas aerolíneas existen en tu <em>dataset</em>?</li>\n  <li>¿Cuántos aviones -<code>tail number</code>- diferentes existen en tu <em>dataset</em>?</li>\n  <li>¿De qué periodo de tiempo tienes vuelos? ¿Tienes datos de todos los días en ese periódo?</li>\n  <li>¿Cuál es el día de la semana con menor demoras de salida?</li>\n  <li>¿Cuál es el origen-destino con el mayor porcentaje de demoras en su salida? ¿Qué porcentaje es?</li>\n  <li>¿Cuál es el aeropuerto destino con mayor número de demoras (número, no duración de la demora)? ¿De qué aerolíneas son el top 3 de demoras de este aeropuerto?</li>\n  <li>¿Cuál es el aeropuerto origen con mayor número de demoras (número, no duración de la demora)? ¿De qué aerolíneas son el top 3 de demoras de este aeropuerto?</li>\n  <li>¿Qué aerolíneas vuelan de Atlanta (Hartsfield-Jackson Atlanta International Airport) a Hawaii (Honolulu International Airport) y en qué dias de la semana y horarios?</li>\n  <li>Si queremos viajar de Atlanta (Hartsfield-Jackson Atlanta International Airport) a Hawaii (Honolulu International Airport) en qué día nos conviene hacerlo para no tener demoras en nuestra salida.</li>\n  <li>Si queremos viajar de Atlanta (Hartsfield-Jackson Atlanta International Airport) a Hawaii (Honolulu International Airport) en qué día nos conviene hacerlo para no tener demoras en nuestra llegada.</li>\n  <li>Si queremos viajar de Atlanta (Hartsfield-Jackson Atlanta International Airport) a Hawaii (Honolulu International Airport) en qué día nos conviene hacerlo para no tener demoras en nuestro viaje. (demora incluyendo demora de salida y demora de llegada).</li>\n  <li>¿Qué aerolínea es a la que más destinos llega?</li>\n  <li>¿Qué aeropuerto es el que recibe más destinos?</li>\n  <li>¿Qué aeropuerto es el que llega a más destinos?</li>\n  <li>¿Qué aeropuerto es el más puntual los fines de semana para salidas?</li>\n  <li>¿Qué aeropuerto es el más puntual los lunes para salidas?</li>\n  <li>¿Qué aeropuerto es el más puntual en todos sus viajes salidas y llegadas?</li>\n  <li>¿Cuál es la ruta con menor demora? ¿Por cuánto es la demora? (Tienen que tener demora, demora = demora de salida + demora de llegada).</li>\n  <li>¿Cuál es la ruta con mayor demora? ¿Por cuánto es la demora? (demora = demora salida + demora de llegada).</li>\n  <li>En qué día de la semana debemos viajar desde el aeropuerto John F. Kennedy para no tener demora en la salida (sin importar el destino).</li>\n</ol>\n</div>"}]},"apps":[],"jobName":"paragraph_1585104918614_966151552","id":"20200324-214952_862897149","dateCreated":"2020-03-25T02:55:18+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:288"},{"text":"%pyspark\nflights_csv.describe().show()","user":"anonymous","dateUpdated":"2020-03-25T02:55:18+0000","config":{"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/python","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+-------+-------+------------------+-----------------+------------------+-------+------------------+-----------+------------------+-------------------+-------------------+------------------+------------------+-----------------+------------------+-----------------+------------------+------------------+-----------------+------------------+------------------+------------------+------------------+-----------------+--------------------+--------------------+-------------------+------------------+-------------------+------------------+-------------------+------------------+\n|summary|   YEAR|             MONTH|              DAY|       DAY_OF_WEEK|AIRLINE|     FLIGHT_NUMBER|TAIL_NUMBER|    ORIGIN_AIRPORT|DESTINATION_AIRPORT|SCHEDULED_DEPARTURE|    DEPARTURE_TIME|   DEPARTURE_DELAY|         TAXI_OUT|        WHEELS_OFF|   SCHEDULED_TIME|      ELAPSED_TIME|          AIR_TIME|         DISTANCE|         WHEELS_ON|           TAXI_IN| SCHEDULED_ARRIVAL|      ARRIVAL_TIME|    ARRIVAL_DELAY|            DIVERTED|           CANCELLED|CANCELLATION_REASON|  AIR_SYSTEM_DELAY|     SECURITY_DELAY|     AIRLINE_DELAY|LATE_AIRCRAFT_DELAY|     WEATHER_DELAY|\n+-------+-------+------------------+-----------------+------------------+-------+------------------+-----------+------------------+-------------------+-------------------+------------------+------------------+-----------------+------------------+-----------------+------------------+------------------+-----------------+------------------+------------------+------------------+------------------+-----------------+--------------------+--------------------+-------------------+------------------+-------------------+------------------+-------------------+------------------+\n|  count|5819079|           5819079|          5819079|           5819079|5819079|           5819079|    5804358|           5819079|            5819079|            5819079|           5732926|           5732926|          5730032|           5730032|          5819073|           5714008|           5714008|          5819079|           5726566|           5726566|           5819079|           5726566|          5714008|             5819079|             5819079|              89884|           1063439|            1063439|           1063439|            1063439|           1063439|\n|   mean| 2015.0| 6.524085168804204|15.70459397440729|3.9269411877721545|   null|2173.0927423394664|       null|12666.699787109315| 12666.853627883538| 1329.6024700816056|1335.2044390595659| 9.370158275198389|16.07166225249702|1357.1708412797695|141.6858915500802|137.00618917579393|113.51162809012519|822.3564947305235|1471.4686087613413|7.4349708010001105|1493.8082485218022|1476.4911879126164|4.407057357987598|0.002609863175942...|0.015446430612129514|               null|13.480568231934319|0.07615387436420895|18.969546913363153| 23.472837652183152| 2.915289922600168|\n| stddev|    0.0|3.4051368280554697|8.783425069807226|1.9888450134329902|   null| 1757.063998786621|       null|1526.7134944584895| 1526.6619201888464| 483.75182087310947|496.42326011941964|37.080942496786925| 8.89557406544984| 498.0093562214942| 75.2105823060021| 74.21107169828007|  72.2308216202854|607.7842873170453| 522.1879449700449|5.6385476873222045|507.16469559369585| 526.3197372122685|39.27129709388602|0.051020116008060244| 0.12332007544158718|               null|28.003678900236313| 2.1434595705026056|48.161641898325605| 43.197018477241386|20.433335717631316|\n|    min|   2015|                 1|                1|                 1|     AA|                 1|      7819A|             10135|              10135|                  1|                 1|               -82|                1|                 1|               18|                14|                 7|               21|                 1|                 1|                 1|                 1|              -87|                   0|                   0|                  A|                 0|                  0|                 0|                  0|                 0|\n|    max|   2015|                12|               31|                 7|     WN|              9855|     N9EAMQ|               YUM|                YUM|               2359|              2400|              1988|              225|              2400|              718|               766|               690|             4983|              2400|               248|              2400|              2400|             1971|                   1|                   1|                  D|              1134|                573|              1971|               1331|              1211|\n+-------+-------+------------------+-----------------+------------------+-------+------------------+-----------+------------------+-------------------+-------------------+------------------+------------------+-----------------+------------------+-----------------+------------------+------------------+-----------------+------------------+------------------+------------------+------------------+-----------------+--------------------+--------------------+-------------------+------------------+-------------------+------------------+-------------------+------------------+\n\n"}]},"apps":[],"jobName":"paragraph_1585104918615_1932359165","id":"20200324-220346_727531578","dateCreated":"2020-03-25T02:55:18+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:289"},{"text":"%pyspark\nflights_csv.describe([\"YEAR\",\"MONTH\",\"DAY\"]).show()","user":"anonymous","dateUpdated":"2020-03-25T02:55:18+0000","config":{"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/python","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+-------+-------+------------------+-----------------+\n|summary|   YEAR|             MONTH|              DAY|\n+-------+-------+------------------+-----------------+\n|  count|5819079|           5819079|          5819079|\n|   mean| 2015.0| 6.524085168804204|15.70459397440729|\n| stddev|    0.0|3.4051368280554737|8.783425069806755|\n|    min|   2015|                 1|                1|\n|    max|   2015|                12|               31|\n+-------+-------+------------------+-----------------+\n\n"}]},"apps":[],"jobName":"paragraph_1585104918615_1625897029","id":"20200324-221331_1728119348","dateCreated":"2020-03-25T02:55:18+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:290"}],"name":"sql_tutorial","id":"2F4KGDU3P","noteParams":{},"noteForms":{},"angularObjects":{"md:shared_process":[],"python:shared_process":[],"sh:shared_process":[],"spark:shared_process":[]},"config":{"isZeppelinNotebookCronEnable":false,"looknfeel":"default","personalizedMode":"false"},"info":{}}