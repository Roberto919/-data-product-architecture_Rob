{"paragraphs":[{"text":"%pyspark\n\nfrom pyspark.ml.linalg import Vectors\nfrom pyspark.ml.feature import StandardScaler\n\n# Creamos el data frame que queremos estandarizar\ndata_frame = spark.createDataFrame([\n    (0, Vectors.dense([1.0, 0.1, -1.0]),),\n    (1, Vectors.dense([2.0, 1.1, 1.0]),),\n    (2, Vectors.dense([3.0, 10.1, 3.0]),)\n], [\"id\", \"features\"])\n# Configuramos el estimator StandarScaler como lo necesitamos (por default\n# withMean esta en False porque hace que se regrese un vector dense...\n# hay que tener cuidado con eso cuando estemos manejandoo vectores sparse\nscaler = StandardScaler(inputCol=\"features\", outputCol=\"scaled_features\",\n                        withStd=True, withMean=True)\n# Creamos el modelo StandardScaler para los datos de entrada\nscaler_model = scaler.fit(data_frame)\n\n# Transformamos los datos \nscaled_data = scaler_model.transform(data_frame)\nscaled_data.show(truncate=False)","user":"anonymous","dateUpdated":"2020-03-31T22:16:40+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+---+--------------+-------------------------------+\n|id |features      |scaled_features                |\n+---+--------------+-------------------------------+\n|0  |[1.0,0.1,-1.0]|[-1.0,-0.6657502859356826,-1.0]|\n|1  |[2.0,1.1,1.0] |[0.0,-0.4841820261350419,0.0]  |\n|2  |[3.0,10.1,3.0]|[1.0,1.1499323120707245,1.0]   |\n+---+--------------+-------------------------------+\n\n"}]},"apps":[],"jobName":"paragraph_1585692993409_-604022147","id":"20200331-221633_896477851","dateCreated":"2020-03-31T22:16:33+0000","dateStarted":"2020-03-31T22:16:40+0000","dateFinished":"2020-03-31T22:16:41+0000","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:6295"},{"text":"%pyspark\n","user":"anonymous","dateUpdated":"2020-03-31T22:16:40+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{}},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1585693000802_1922620808","id":"20200331-221640_1076400365","dateCreated":"2020-03-31T22:16:40+0000","status":"READY","progressUpdateIntervalMs":500,"$$hashKey":"object:6296"}],"name":"sparkml_standard_scaler","id":"2F727WJ6A","noteParams":{},"noteForms":{},"angularObjects":{"md:shared_process":[],"spark:shared_process":[]},"config":{"isZeppelinNotebookCronEnable":false,"looknfeel":"default","personalizedMode":"false"},"info":{}}